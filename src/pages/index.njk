{% extends "layouts/page.njk" %}
{% import "includes/forms.njk" as forms %}

{% block title %}
Formulaire d'inscription
{% endblock %}
{% block scripts %}
    <script type="module" src="/src/assets/scripts/sign-in-form.ts" defer></script>
    <script type="module" src="/src/assets/scripts/user-signature.ts" defer></script>
    <script type="module" src="/src/assets/scripts/terms-of-service.ts" defer></script>
{% endblock %}
{% block content %}
    <header class="mb-10 max-w-3xl mx-auto px-3">
        <h1 class="text-5xl text-black-numixs font-bold title-font mb-2.5">
   Formulaire d'inscription FacLab<sup>®</sup> numixs
</h1>
        <p>Bienvenue ! Merci de prendre quelques instants pour vous inscrire au FacLab® numixs.</p>
        <p>Merci de remplir les informations demandées et de lire le règlement avant de valider votre
enregistrement.</p>
    </header>
    <hr class="bg-gray-input-border-numixs">
    <div class="mt-8 px-3">
        <form class="grid grid-cols-2 gap-6 max-w-3xl mx-auto" type="mul" novalidate action="" method="post" data-sign-in-form>
            <ul class="form-errors-list-container col-span-full" role="alert" data-form-errors id="error-container"></ul>
            <p class="col-span-full">
                <span class="text-red-500 ">*</span> : Champ obligatoire</p>
            <div class="flex flex-col">
                <label for="prenom">Prénom<span class="text-red-500">*</span></label>
                <input type="text" required id="prenom" placeholder="Jean" name="prenom" class="input">
            </div>
            <div class="flex flex-col">
                <label for="nom">Nom<span class="text-red-500">*</span></label>
                <input type="text" required placeholder="Dubeau" id="nom" name="nom" class="input">
            </div>

            <div class="flex flex-col">
                <label for="numero_telephone">Numéro de téléphone</label>
                <input type="tel" placeholder="01 33 33 33 33" id="numero_telephone" name="numero_telephone" class="input">
            </div>
            <div class="flex flex-col">
                <label for="email">E-mail<span class="text-red-500">*</span></label>
                <input type="email" required placeholder="hello@numixs.com" id="email" name="email" class="input">
            </div>
            <div class="flex flex-col col-span-full">
                <label for="adresse">Adresse</label>
                <input type="text" placeholder="Rue Jacques-Henri Labourdette" id="adresse" name="adresse" class="input">
            </div>
            <div class="flex flex-col">
                <label for="ville">Ville</label>
                <input type="text" placeholder="Sarcelles" id="ville" name="ville" class="input">
            </div>
            {# <div class="flex flex-col">
                <label for="region">Région</label>
                <input type="text" id="region" name="region" class="input">
            </div> #}
            <div class="flex flex-col">
                <label for="code_postal">Code postal<span class="text-red-500">*</span></label>
                <input type="text" required id="code_postal" maxlength="5" inputmode="numeric" placeholder='95200' name="code_postal" class="input">
            </div>
            <div class="flex flex-col col-span-full gap-3">
                <div>
                    <p>Quels sont vos secteurs d'activité ?<span class="text-red-500">*</span></p>
                    <p class="text-sm opacity-70 -mt-1">Choisir au moins un secteur</p>
                </div>
                {% for sector in list_business_sector %}

                    {{ forms.switch(sector.name, sector.value, value = "oui", color = "peer-checked:bg-green-numixs", ring_color = "peer-focus:ring-dark-green-numixs/30") }}
                {% endfor %}
            </div>
            <div class="flex flex-col col-span-full">
                <label for="extra_infos">Une information à rajouter ?</label>
                <textarea name="extra_infos" id="extra_infos" rows="5" placeholder="Écrire ici..." class="input"></textarea>
            </div>

            <p class="text-black-numixs font-bold title-font col-span-full text-4xl">
                Règlement intérieur du FacLab<sup>®</sup> de la Station numixs
            </p>
            <div class="col-span-full h-120">
                {# <canvas id="pdf-canvas"></canvas> #}

                <iframe src="/reglement" class="w-full h-full" data-terms-of-service frameborder="0"></iframe>
                {# <iframe src="/file.tmp.pdf" class="w-full h-full" data-terms-of-service frameborder="0"></iframe> #}
            </div>
            <div class="col-span-full">
                <input class="aspect-square accent-green-numixs mr-2.5" type="checkbox" name="reglement" id="reglement">
                <label for="reglement">En cochant cette case, je déclare avoir lu et accepté l’intégralité du règlement
disponible ci-dessus.<span class="text-red-500">*</span></label>
            </div>
            <div class="col-span-full">
                <input required class="aspect-square accent-green-numixs mr-2.5" type="checkbox" name="donnees_personnelles" id="donnees_personnelles">
                <label for="donnees_personnelles">J’accepte que mes données soient utilisées pour les inscriptions et participations
au FacLab® numixs.</label>
            </div>

            <div class="flex flex-col col-span-full">
                <p>Signature<span class="text-red-500">*</span></p>
                <div class="relative border border-black-numixs overflow-hidden border-solid rounded-md aspect-[658/113] signature-placeholder">
                    <input type="checkbox" name="signature" class="absolute -left-5000 opacity-0">
                    <canvas data-user-signature class="bg-white"></canvas>
                    <button data-clear-signature-button type="button" class="w-10 aspect-square rounded-full bg-green-numixs absolute right-2 bottom-2 flex justify-center items-center fill-black-numixs hocus:bg-dark-green-numixs">
                        {% include "includes/icon-eraser.svg" %}
                    </button>
                </div>
            </div>

            <div class="col-span-full">
                <button type="submit" class="bg-green-numixs w-fit rounded-md px-16 py-3.5 mx-auto block hocus:bg-dark-green-numixs">Envoyer</button>
            </div>
        </form>
    </div>

    <dialog data-dialog="form-submitted" class="backdrop:bg-[#F5F5F5] m-auto max-w-2xl w-full bg-transparent ">
        <div class="flex gap-2 flex-col py-4">
            <img src="/images/faclab-logo.svg" class="w-44 mx-auto block" alt="">
            <div class="flex justify-center flex-col items-center" data-swap-content>
                <img src="/images/loading.svg" class="animate-spin w-16" alt="">
            </div>
        </div>
    </dialog>
    <template data-template-id="form-success">
        <img src="/images/valide.svg" class="w-16" alt="">
        <p class="text-center w-44 mx-auto">Votre inscription a bien été effectuée</p>

        <button type="button" data-close-dialog class="bg-green-numixs w-fit rounded-md px-16 py-3.5 mx-auto block mt-8 active:bg-dark-green-numixs">Continuer</button>
    </template>
    <template data-template-id="form-error">
        <img src="/images/valide.svg" class="w-16" alt="">
        <p class="text-center w-44 mx-auto">Une erreur est survenue lors de votre inscription</p>

        <button type="button" data-close-dialog class="bg-green-numixs w-fit rounded-md px-16 py-3.5 mx-auto block mt-8 active:bg-dark-green-numixs">Continuer</button>
    </template>
{% endblock %}
