{% extends "layouts/page.njk" %}

{% block title %}
Listes lieux numixs
{% endblock %}

{% import "includes/macros.njk" as macros %}

{% set active_menu_item = "lieu" %}
{% set date_format = "dd/LL/yyyy à HH:mm" %}
{% set root_class = "admin" %}

{% block scripts %}
    {% if NODE_ENV == "development" %}
        <script type="module" src="/src/assets/scripts/delete-place-dialog.ts" defer></script>
    {% else %}
        <script type="module" src="/{{ manifest['src/assets/scripts/delete-place-dialog.ts'].file }}" defer></script>
    {% endif %}
{% endblock %}
{% block content %}
    <div data-notifications-container class="fixed left-2 top-2 z-50 empty:h-0"></div>
    <div class="mt-8 pr-[max(env(safe-area-inset-right),_theme(space.3))] pl-[max(env(safe-area-inset-left),_theme(space.3))] grid grid-cols-1 xl:grid-cols-[260px_minmax(0,_1fr)] gap-6">
        {% include "includes/admin-nav.njk" %}
        <div class="bg-slate-50 rounded-md py-5 px-6 md:py-10 md:px-13">
            <header class="flex flex-col md:flex-row gap-y-3 justify-between md:items-center mb-10 -mt-1.5">
                <h1 class="text-black-numixs title-font font-bold text-6xl">Liste lieux numixs</h1>
                <a href="/lieu" class="bg-black-numixs hocus:bg-black px-3.5 py-1.5 rounded-xl text-white self-start md:self-auto">Créer un nouvel lieu</a>
            </header>
            <div class="text-black-numixs">
                <div class="overflow-x-auto">
                    {% include "includes/form-banner-success.njk" %}
                    <table class="w-full bg-white border-collapse whitespace-nowrap">
                        <thead>
                            <tr class="bg-gray-200">
                                <td class="font-bold px-4 py-3 text-left">#</td>
                                <td class="font-bold px-4 py-3 text-left">Nom</td>
                                <td class="font-bold px-4 py-3 text-left">Heures d'ouverture</td>
                                <td class="font-bold px-4 py-3 text-left">Jours fermés</td>
                                <td class="font-bold px-4 py-3 text-left">Ouvert</td>
                                <td class="font-bold px-4 py-3 text-left"></td>
                            </tr>
                        </thead>
                        <tbody>
                            {% for place in places_list %}
                                <tr class="even:bg-green-numixs/50 group hover:bg-slate-200" data-member-row>
                                    <td class="group-hover:bg-slate-200 bg-gray-100 group-even:bg-green-numixs/50 px-4 py-3 text-left">{{ loop.index }}</td>
                                    <td class="group-hover:bg-slate-200 bg-gray-100 group-even:bg-green-numixs/50 px-4 py-3 text-left">{{ place.nom }}</td>
                                    <td class="group-hover:bg-slate-200 bg-gray-100 group-even:bg-green-numixs/50 px-4 py-3 text-left">{{ place.heure_ouverture }}-{{ place.heure_fermeture }}</td>
                                    <td class="group-hover:bg-slate-200 bg-gray-100 group-even:bg-green-numixs/50 px-4 py-3 text-left">{{ place.jours_fermeture or "Aucun" }}</td>
                                    <td class="group-hover:bg-slate-200 bg-gray-100 group-even:bg-green-numixs/50 px-4 py-3 text-left">{{ "Oui" if place.ouvert == 1 else "Non" }}</td>
                                    <td class="group-hover:bg-slate-200 bg-gray-100 group-even:bg-green-numixs/50 px-4 py-3 text-left">
                                        <div class="flex flex-row gap-3">
                                            <a href="/lieu/{{ place.id }}" class="font-bold hocus:opacity-75">Éditer</a>
                                            <button type="button" class="font-bold text-red-800 hover:text-red-950" commandfor="delete-place" command="show-modal" data-place-id="{{ place.id }}">Supprimer</button>
                                        </div>
                                    </td>
                                </tr>
                            {% else %}
                                <tr class="">
                                    <td colspan="6" class="px-4 py-3 text-center">
                                        Pas de lieux
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <dialog id="delete-place" class="bg-black-numixs shadow-2xl rounded-md p-3 text-white-numixs backdrop:bg-black-numixs/35 -translate-1/2 left-1/2 top-1/2 w-11/12 max-w-2xl border border-solid border-green-numixs">
        <header class="flex flex-row justify-between items-start">
            <div>
                <p class="title-font text-4xl">Supprimer</p>
            </div>
        </header>

        <hr class="pb-1 mt-1 border-red-800">
        <p class="p-4 bg-red-50 text-red-800 border-t-4 border-t-red-800 mb-4">Cette action est irréversible. Supprimer ce lieu entraînera la suppression des visites associées</p>

        <form method="post" action="/lieu/suppression">
            <input type="hidden" name="id" value=""/>
            <div class="flex flex-row gap-3">
                <button type="submit" class="text-white-numixs bg-red-800 hocus:bg-red-950 px-3 py-1.5 rounded-xl">Supprimer</button>
                <button type="button" command="close" commandfor="delete-place" class="bg-black-numixs hocus:bg-black px-3.5 py-1.5 rounded-xl text-white-numixs">Annuler</button>
            </div>
        </form>
    </dialog>

{% endblock %}
